import requests

{%~ if method in ['post', 'put', 'patch'] and sample_data is not empty %}
data = {{ sample_data|json_encode(constant('JSON_PRETTY_PRINT'))|raw }}

{% endif -%}

url = "{{ base_url }}{{ uri }}"
headers = {
    "Content-Type": "application/json",
{% if security_enabled -%}
    {% if 'BearerToken' in security_schemes and 'BasicAuth' in security_schemes %}
    "Authorization": 'Basic API_KEY:API_SECRET_KEY', # Or with Bearer eyJ0eXAiOiJKV1QiLCJ...
    {%~ elseif 'BearerToken' in security_schemes %}
    "Authorization" 'Bearer eyJ0eXAiOiJKV1QiLCJ...'
    {%~ elseif 'BasicAuth' in security_schemes %}
    "Authorization": 'Basic API_KEY:API_SECRET_KEY'
    {%~ endif -%}
{% endif %}
}

response = requests.{{ method }}(
    url,
    headers=headers,
{% if method in ['post', 'put', 'patch']  and sample_data is not empty %}
    json=data
{% endif %}
)

print(response.status_code)
print(response.json())
